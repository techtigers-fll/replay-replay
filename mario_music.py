from robot import Pid, Robot,LineEdge, LineSensor
from pybricks.parameters import Stop
from pybricks.hubs import EV3Brick

def run(robot: Robot):
    brick = EV3Brick()

    music = [
    ["E4/16", "E4/8", "E4/8", "C4/16", "E4/8", "G4/4", "G3/4"],

    ["C4/8.", "G3/8.", "E3/8", "R/16", "A3/8", "B3/8", "Bb3/16", "A3/8"],
    ["G3/16.","E4/16.", "G4/16.", "A4/5", "F4/16", "G4/8", "E4/8", "C4/16",
    "D4/16", "B3/16"],

    ["R/4", "G4/16", "Gb4/16", "F4/16", "D#4/8", "E4/16", "R/16", "G3/16",
    "A3/16", "C4/16", "R/16", "A3/16", "C4/16", "D4/16", "R/8"],

    ["G4/16", "Gb4/16", "F4/16", "D#4/8", "E4/16", "R/16",  "C5/16", "R/16",
    "C5/16", "C5/4"],

    ["R/4", "G4/16", "Gb4/16", "F4/16", "D#4/8", "E4/16", "R/16", "G3/16",
    "A3/16", "C4/16", "R/16", "A3/16", "C4/16", "D4/16"],
    ["R/8", "Eb4/8", "R/16", "D4/8.", "C4/4", "R/4"],

    ["C4/16", "C4/8", "C4/8", "C4/16", "D4/8", "E4/16", "C4/8", "A3/16", "G3/4"],
    ["C4/16", "C4/8", "C4/8", "C4/16", "D4/16", "E4/16", "R/2"],

    ["C4/16", "C4/8", "C4/8", "C4/16", "D4/8", "E4/16", "C4/8", "A3/16", "G3/4"],
    ["E4/16", "E4/8", "E4/8", "C4/16", "E4/8", "G4/4", "G3/4"],

    ["E4/16", "C4/8", "G3/8", "G#3/8", "A3/16", "F4/8", "F4/16", "A3/4"],
    ["B3/16.", "A4/16.", "A4/16.", "A4/16.", "G4/16.", "F4/16.", "E4/16", "C4/8",
    "A3/16", "G3/4"],

    ["E4/16", "C4/8", "G3/8", "G#3/8", "A3/16", "F4/8", "F4/16", "A3/4"],
    ["B3/16","F4/8", "F4/16", "F4/16.", "E4/16.", "D4/16.", "C4/4", "R/8"],
    ]
    duration = [0, 2400, 2700, 2420, 2470, 2420, 2740, 2260, 2160, 2250, 2540, 2800,
            1920, 2560, 2170, 2250]
    speed = 200
    counter = 0
    while True:
        if robot.dance(speed, duration[counter % len(duration)]):
            brick.speaker.play_notes(music[counter % len(music)], 100)
            counter += 1

